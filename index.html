<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" name="viewport" content="width=device-width, initial-scale=1">
    <title>Test your coding skills</title>

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet">
<link href='https://fonts.googleapis.com/css?family=Alegreya+Sans+SC:900,500' rel='stylesheet' type='text/css'>
<link href='https://fonts.googleapis.com/css?family=Josefin+Sans:300,600' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    
<style>
    h1,h2,h3 {
        font-family: 'Alegreya Sans SC', impact;
    }
    
    body {
        margin: 0;
        background-color: #f8f8f8;
        font-family: 'Josefin Sans', Arial, sans-serif;
        font-size: 1.7em;
    }
    
    textarea.code {
        font-family: 'Monaco', monospace;
    }
    
    .button-row {
        margin-top: 8px;
    }
</style>

</head>

<body>
<div class="container-fluid">
    <br>
    <h1 class="text-center text-primary">Test your coding skills</h1>
    <br>
    
    <h2>Introduction</h2>
    <p>I'm experimenting with making a page of coding tests. So far, I have a basic framework that can accept code and test that it gives the correct result for a range of different inputs (try the code box belows). I hope to make it easy for people to adapt to their own challenges.</p>

<div class="challenge well">
    <h3>Challenge 1</h3>
    <p>As a simple warm up, write a function called <code>square</code> that takes a single parameter which will always be a number and returns the square of that number.</p>
        
    <div class="form-group code-input">
        <label for="comment">Code:</label>
        <!-- Messages -->
        <div style="display:none;" class="alert alert-info">
            <strong>Hint:</strong> <span class="message"></span>
        </div>
        <div style="display:none;" class="alert alert-success">
            <strong>Success!</strong> <span class="message">All tests passed.</span>
        </div>
        <div style="display:none;" class="alert alert-danger">
            <strong>Error!</strong> <span class="message"></span>
        </div>
        <div style="display:none;" class="alert alert-warning">
            <strong>Test Failed!</strong> <span class="message"></span>
        </div>
    
        <textarea spellcheck="false" class="form-control code" rows="5" id="comment">var square = function(n) {
    // Return n squared

};
</textarea>
    <div class="row button-row">
        <div class="col-xs-4">
            <button class="btn btn-block btn-primary"> <i class="fa fa-paper-plane"></i> Submit</button>
        </div>
        <div class="col-xs-4">
            <button class="btn btn-block btn-info"><i class="fa fa-info-circle"></i> Hint</button>
        </div>
        <div class="col-xs-4">
            <button class="btn btn-block btn-danger"><i class="fa fa-trash"></i> Clear</button>
        </div>
        </div>
    </div>
</div>

<div class="challenge well">
    <h3>Challenge 2</h3>
    <p>Now for something a bit harder. Can you write a function, <code>mean</code>, that returns the mean of an array of numbers.</p>
        
    <div class="form-group code-input">
        <label for="comment">Code:</label>
        <!-- Messages -->
        <div style="display:none;" class="alert alert-info">
            <strong>Hint:</strong> <span class="message"></span>
        </div>
        <div style="display:none;" class="alert alert-success">
            <strong>Success!</strong> <span class="message">All tests passed.</span>
        </div>
        <div style="display:none;" class="alert alert-danger">
            <strong>Error!</strong> <span class="message"></span>
        </div>
        <div style="display:none;" class="alert alert-warning">
            <strong>Test Failed!</strong> <span class="message"></span>
        </div>
    
        <textarea spellcheck="false" class="form-control code" rows="6" id="comment">var mean = function(arr) {
    // Return the mean value of the numbers in arr
    
};
</textarea>
    <div class="row button-row">
        <div class="col-xs-4">
            <button class="btn btn-block btn-primary"> <i class="fa fa-paper-plane"></i> Submit</button>
        </div>
        <div class="col-xs-4">
            <button class="btn btn-block btn-info"><i class="fa fa-info-circle"></i> Hint</button>
        </div>
        <div class="col-xs-4">
            <button class="btn btn-block btn-danger"><i class="fa fa-trash"></i> Clear</button>
        </div>
        </div>
    </div>
</div>

<div class="challenge well">
    <h3>Challenge 3</h3>
    <p>Now we know the mean, what about the median? Write a function, <code>median</code>, that returns the median of an array of numbers.</p>
        
    <div class="form-group code-input">
        <label for="comment">Code:</label>
        <!-- Messages -->
        <div style="display:none;" class="alert alert-info">
            <strong>Hint:</strong> <span class="message"></span>
        </div>
        <div style="display:none;" class="alert alert-success">
            <strong>Success!</strong> <span class="message">All tests passed.</span>
        </div>
        <div style="display:none;" class="alert alert-danger">
            <strong>Error!</strong> <span class="message"></span>
        </div>
        <div style="display:none;" class="alert alert-warning">
            <strong>Test Failed!</strong> <span class="message"></span>
        </div>
    
        <textarea spellcheck="false" class="form-control code" rows="8" id="comment">var median = function(arr) {
    // Return the median value of the numbers in arr
    
};
</textarea>
    <div class="row button-row">
        <div class="col-xs-4">
            <button class="btn btn-block btn-primary"> <i class="fa fa-paper-plane"></i> Submit</button>
        </div>
        <div class="col-xs-4">
            <button class="btn btn-block btn-info"><i class="fa fa-info-circle"></i> Hint</button>
        </div>
        <div class="col-xs-4">
            <button class="btn btn-block btn-danger"><i class="fa fa-trash"></i> Clear</button>
        </div>
        </div>
    </div>
</div>

<div class="challenge well">
    <h3>Challenge 4</h3>
    <p>Write a function, <code>Fibonacci</code> that, given a number, n, returns the nth Fibonacci number. Here the function should be defined such that <code>Fibonacci(0) = 0</code> and <code>Fibonacci(1) = 1</code>. For all larger values the nth Fibonacci number is the sum of the previous two Fibonacci numbers.</p>
        
    <div class="form-group code-input">
        <label for="comment">Code:</label>
        <!-- Messages -->
        <div style="display:none;" class="alert alert-info">
            <strong>Hint:</strong> <span class="message"></span>
        </div>
        <div style="display:none;" class="alert alert-success">
            <strong>Success!</strong> <span class="message">All tests passed.</span>
        </div>
        <div style="display:none;" class="alert alert-danger">
            <strong>Error!</strong> <span class="message"></span>
        </div>
        <div style="display:none;" class="alert alert-warning">
            <strong>Test Failed!</strong> <span class="message"></span>
        </div>
    
        <textarea spellcheck="false" class="form-control code" rows="8" id="comment">var fibonacci = function(n) {
    // Return the nth Fibonacci number
    
};
</textarea>
    <div class="row button-row">
        <div class="col-xs-4">
            <button class="btn btn-block btn-primary"> <i class="fa fa-paper-plane"></i> Submit</button>
        </div>
        <div class="col-xs-4">
            <button class="btn btn-block btn-info"><i class="fa fa-info-circle"></i> Hint</button>
        </div>
        <div class="col-xs-4">
            <button class="btn btn-block btn-danger"><i class="fa fa-trash"></i> Clear</button>
        </div>
        </div>
    </div>
</div>

<div class="challenge well">
    <h3>Challenge 5</h3>
    <p>Now for a tricky one. Write a function <code>GCF</code>, that takes two numbers and returns the greatest common divisor of the two.</p>
        
    <div class="form-group code-input">
        <label for="comment">Code:</label>
        <!-- Messages -->
        <div style="display:none;" class="alert alert-info">
            <strong>Hint:</strong> <span class="message"></span>
        </div>
        <div style="display:none;" class="alert alert-success">
            <strong>Success!</strong> <span class="message">All tests passed.</span>
        </div>
        <div style="display:none;" class="alert alert-danger">
            <strong>Error!</strong> <span class="message"></span>
        </div>
        <div style="display:none;" class="alert alert-warning">
            <strong>Test Failed!</strong> <span class="message"></span>
        </div>
    
        <textarea spellcheck="false" class="form-control code" rows="8" id="comment">var gcf = function(n1, n2) {
    // Return the greatest common factor of n1 and n2
    
};
</textarea>
    <div class="row button-row">
        <div class="col-xs-4">
            <button class="btn btn-block btn-primary"> <i class="fa fa-paper-plane"></i> Submit</button>
        </div>
        <div class="col-xs-4">
            <button class="btn btn-block btn-info"><i class="fa fa-info-circle"></i> Hint</button>
        </div>
        <div class="col-xs-4">
            <button class="btn btn-block btn-danger"><i class="fa fa-trash"></i> Clear</button>
        </div>
        </div>
    </div>
</div>
    
</div>

<script>
/**************************************************
        Write challenges here
 Challenges should consist of writing a function
 with a given name. The function is tested by
 calling it with the inputs in each test and
 checking whether it returns the expected output.
**************************************************/    

    var challenges = [
        {
            functionName: 'square',
            hint: "The square of a number is that number multiplied by itself.",
            tests: [
                {
                    inputs: [5],
                    output: 25
                },
                {
                    inputs: [10001],
                    output: 100020001
                },
                {
                    inputs: [-3],
                    output: 9
                },
                {
                    inputs: [0],
                    output: 0
                },
                {
                    inputs: [2.25],
                    output: 5.0625
                }
            ]
        },
        {
            functionName: 'mean',
            hint: "The mean is calculated by taking the sum of the digits and dividing by the number of digits.",
            tests: [
                {
                    inputs: [[1, 2, 3, 4]],
                    output: 2.5
                },
                {
                    inputs: [[7]],
                    output: 7
                },
                {
                    inputs: [[-4, -11, 7, 8]],
                    output: 0
                },
                {
                    inputs: [[1.1, 3.4, 7.5]],
                    output: 4
                }
            ]
        },
        {
            functionName: 'median',
            hint: "The median is the middle value when the numbers are in numerical order. If there is an even number of numbers, the median is the mean of the middle two numbers",
            tests: [
                {
                    inputs: [[1, 2, 3, 4]],
                    output: 2.5
                },
                {
                    inputs: [[7]],
                    output: 7
                },
                {
                    inputs: [[-4, -11, 7, 8]],
                    output: 1.5
                },
                {
                    inputs: [[0, 4, 30, 200, 1000]],
                    output: 30
                },
                {
                    inputs: [[1.1, 7.5, 3.4]],
                    output: 3.4
                }
            ]
        },
        {
            functionName: 'fibonacci',
            hint: "This can be done recursively, but it's a lot more efficient to use a for loop to calculate the Fibonacci numbers from 2 to n.",
            tests: [
                {
                    inputs: [0],
                    output: 0
                },
                {
                    inputs: [1],
                    output: 1
                },
                {
                    inputs: [2],
                    output: 1
                },
                {
                    inputs: [10],
                    output: 55
                },
                {
                    inputs: [38],
                    output: 39088169
                }
            ]
        },
        {
            functionName: 'gcf',
            hint: "The GCF of two numbers is the largest factor that both numbers share, e.g. GCF(8, 12) = 4",
            tests: [
                {
                    inputs: [8, 12],
                    output: 4
                },
                {
                    inputs: [6, 6],
                    output: 6
                },
                {
                    inputs: [5, 15],
                    output: 5
                },
                {
                    inputs: [1, 7],
                    output: 1
                },
                {
                    inputs: [11, 12],
                    output: 1
                }
            ]
        },
    ];

    var testInput = function(ans1, ans2) {
        // Assume we won't have objects or arrays of arrays
        if (ans1 instanceof Array && ans2 instanceof Array) {
            for (var i = 0; i < ans1.length; i++) {
                if (ans1[i] !== ans2[i]) {
                    return false;
                }
            }
            return true;
        } else {
            return ans1 === ans2;
        }
    };

    $('.code-input').each(function(i) {
        var $this = $(this);
        
        var $textArea = $($this.find('textarea')[0]);
        var $passAlert = $($this.find('.alert-success')[0]);
        var $hintAlert = $($this.find('.alert-info')[0]);
        var $failAlert = $($this.find('.alert-warning')[0]);
        var $errorAlert = $($this.find('.alert-danger')[0]);
        
        var challenge = challenges[i];
        if (!challenge) { return; }
        var functionName = challenge.functionName;
        var tests = challenge.tests;
        var regex = new RegExp(functionName, "g");
        
        $this.find('.btn-primary').click(function() {
            var code = $textArea.val();
            code = code.replace(regex, '__testFunction__');
        
            // Just in case people want overwrite the test function
            code = code.replace('/testInput/g', '__testInput__');
            
            try {
                eval(code);
                var passed = true;
                
                for (var j = 0; j < tests.length; j++) {
                    var test = tests[j];
                    var result = __testFunction__.apply(null, test.inputs);
                    if (!testInput(test.output, result)) {
                        passed = false;
                        $failAlert.find('.message').text("Test failed with input '" + test.inputs + "'. Expected result " + test.output + ", but got " + result + ".");
                        $failAlert.show(100);
                        $passAlert.hide();
                        $errorAlert.hide();
                        break;
                    }
                }
                
                if (passed) {
                    var n = tests.length;
                    $failAlert.hide();
                    $errorAlert.hide();
                    $passAlert.find('.message').text(n + "/" + n + " tests passed.");
                    $passAlert.show(100);
                }
                
            } catch (e) {
                $failAlert.hide();
                $passAlert.hide();
                $errorAlert.find('.message').text(e);
                $errorAlert.show(100);
            }
        });
        
        $this.find('.btn-info').click(function() {
            if (challenge.hint) {
                $hintAlert.find('.message').text(challenge.hint);
                $hintAlert.show(100);
            } else {
                alert("Sorry, there is no hint for this challenge.");
            }
        });
        
        $this.find('.btn-danger').click(function() {
            $textArea.val('');
        });
    });
</script>
    
</body>
</html>
